#!/usr/bin/env php
<?php

# Bootstrap autoloader (start autoloader from outside or inside the vendor folder)
$autoloaderPaths = [
    dirname(__DIR__, 3).'/autoload.php',
    dirname(__DIR__).'/vendor/autoload.php',
];
foreach ($autoloaderPaths as $autoloaderPath) {
    if (file_exists($autoloaderPath)) {
        require $autoloaderPath;
        break;
    }
}

use Ahc\Cli\Application;
use Ixnode\PhpVault\Core;
use Ixnode\PhpVault\Command\BaseCommand;
use Ixnode\PhpVault\Command\GenerateKeysCommand;
use Ixnode\PhpVault\Command\DisplayEnvCommand;
use Ixnode\PhpVault\Command\DisplayCommand;
use Ixnode\PhpVault\Command\SetCommand;
use Ixnode\PhpVault\Command\EncryptFileCommand;
use Ixnode\PhpVault\Command\DecryptFileCommand;
use Ixnode\PhpVault\Command\InfoCommand;

/* Init App with name and version */
$app = new Application(Core::NAME, Core::VERSION);

/* Add commands with optional aliases */
$app->add(new GenerateKeysCommand(), GenerateKeysCommand::ALIAS);
$app->add(new DisplayEnvCommand(), DisplayEnvCommand::ALIAS);
$app->add(new DisplayCommand(), DisplayCommand::ALIAS);
$app->add(new SetCommand(), SetCommand::ALIAS);
$app->add(new EncryptFileCommand(), EncryptFileCommand::ALIAS);
$app->add(new DecryptFileCommand(), DecryptFileCommand::ALIAS);
$app->add(new InfoCommand(), InfoCommand::ALIAS);

/* Set logo */
$app->logo(BaseCommand::LOGO);

/* Handle arguments */
$app->handle($_SERVER['argv']);
